var level=function(){"use strict";function e(t){if(!(this instanceof e))return new e(t);var n=this;this.setupComplete=function(){"COMPLETED"!==t.setup&&(t=Object.assign({},t,{setup:"COMPLETED"}),n.view.render(t),n.logger.info("Setup Complete"))},this.setupFailed=function(){"FAILED"!==t.setup&&(t=Object.assign({},t,{setup:"FAILED"}),n.view.render(t),n.logger.info("Setup Failed"))},this.acknowledgeSplashScreen=function(){t.splashScreenAcknowledged!==!0&&"COMPLETED"===t.setup&&(t=Object.assign({},t,{splashScreenAcknowledged:!0}),n.view.render(t),n.logger.info("Close Splash Screen"))},this.showMenu=function(){t.menuVisible!==!0&&(t=Object.assign({},t,{menuVisible:!0}),n.view.render(t),n.logger.info("Show Menu"))},this.hideMenu=function(){t.menuVisible!==!1&&(t=Object.assign({},t,{menuVisible:!1}),n.view.render(t),n.logger.info("Hide Menu"))},this.selectTheme=function(e){t.theme!==e&&(t=Object.assign({},t,{theme:e,menuVisible:!1}),n.view.render(t),n.logger.info("Select Theme",e))},this.newReading=function(e){t=Object.assign({},t,{reading:e}),n.view.render(t)},this.applyPopState=function(e){t=Object.assign({},t,e),n.view.render(t),n.logger.info("Apply url State",e)}}function t(e){var t="/";e.menuVisible&&(t+="menu");var n="theme="+e.theme;return t+"?"+n}function n(e){var t=/theme=([^&]+)/,n=e.search.slice(1),i=(n.match(t)||[])[1]||"apple",r="/menu"===e.pathname;return{theme:i,menuVisible:r}}function i(e){function r(){return n(c)}function o(e){if(!d){var n=t(e);n!==s&&(u.pushState({},"",n),s=n)}}function a(e){u.replaceState({},"",t(e))}if(!(this instanceof i))return new i(e);var s,c=e.location,u=e.history,l=this,d=!1;Object.defineProperty(this,"state",{get:r,set:o}),this.callback=function(e){console.log(e)},e.onpopstate=function(){d=!0,l.callback(r()),d=!1},a(r())}function r(){var e=this,t=[];this.render=function(n){e.projection=n,t.forEach(function(e){e(n)})},this.addCallback=function(n){e.projection&&n(e.projection),t.push(n)}}function o(e,t,n){t=t||250;var i,r;return function(){var o=n||this,a=Date.now(),s=arguments;i&&i+t>a?(clearTimeout(r),r=setTimeout(function(){i=a,e.apply(o,s)},t)):(i=a,e.apply(o,s))}}function a(e,t){if("number"!=typeof e)return!1;var n=Array.prototype.slice.call(arguments,1);return n.length>0?a.apply(this,n):!0}function s(e){if(!(this instanceof s))return new s(e);if(this.x=e.x,this.y=e.y,this.z=e.z,!a(this.x,this.y,this.z))throw new TypeError("Vector requires numerical values")}function c(e,t){var n=e*t.x,i=e*t.y,r=e*t.z;return new s({x:n,y:i,z:r})}function u(e){if(!e.magnitude||0===e.magnitude)throw new RangeError("Zero vector cannot be normalized");var t=e.x/e.magnitude,n=e.y/e.magnitude,i=e.z/e.magnitude;return new s({x:t,y:n,z:i})}function l(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function d(e,t){var n,i;try{n=u(e),i=u(t)}catch(r){return 0}var o=l(n,i),a=Math.acos(o),s=180/Math.PI*a;return s}function f(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function p(e,t){e.callback=t.applyPopState}function h(e){var t=e.accelerationIncludingGravity,n=!0;try{t=b(t),t=navigator.userAgent.match(/Windows/i)?c(-1,t):navigator.userAgent.match(/Android/i)?t:c(-1,t),n&&j.setupComplete(),j.newReading(t)}catch(i){j.setupFailed()}}function g(e){var t,n=d(x,e);return t=0===n?0:Math.sqrt(n*n/(e.x*e.x+e.y*e.y)),{x:e.x*t,y:e.y*t}}function m(e){return"COMPLETED"===e?"Ready! Click to begin":"FAILED"===e?"No Sensor Detected! Device needs accelerometer":"Loading..."}function y(e){e=e||0;var t,n="",i=(e+"").split("."),r=i[0];-1!=r.indexOf("-")?(n+="-",t=r.split("-")[1],1==t.length&&(n+="0"),n+=t):(n+="+",1==r.length&&(n+="0"),n+=r);var o=i[1]||"0";return 1==o.length&&(o+="0"),n=n+"."+o,n.slice(0,6)}function v(e){var t=e.querySelector("[data-display~=bubble]"),n=e.querySelector("[data-display~=angleX]"),i=e.querySelector("[data-display~=angleY]"),r=e.querySelector("[data-display~=spirit-level]"),o=e.querySelector("[data-display~=splash-screen]"),a=e.querySelector("[data-display~=load-status]");o.addEventListener("click",function(){window.level.acknowledgeSplashScreen()}),Object.defineProperty(this,"splashScreenAcknowledged",{set:function(e){e&&o.classList.add("hidden")}}),Object.defineProperty(this,"loadStatus",{set:function(e){a.innerHTML=e}}),Object.defineProperty(this,"menuVisible",{set:function(e){if("boolean"!=typeof e)throw new TypeError("menuVisible property should be a boolean");e?r.classList.add("minimised"):r.classList.remove("minimised")},enumerable:!0}),Object.defineProperty(this,"angleX",{set:function(e){if("string"!=typeof e)throw new TypeError("angleX property should be a string");t.setAttribute("cx",e),n.innerHTML=e},enumerable:!0}),Object.defineProperty(this,"angleY",{set:function(e){if("string"!=typeof e)throw new TypeError("angleY property should be a string");t.setAttribute("cy",e),i.innerHTML=e},enumerable:!0}),Object.defineProperty(this,"theme",{set:function(e){if("string"!=typeof e)throw new TypeError("theme property should be a string");r.classList.remove("apple"),r.classList.remove("blueberry"),r.classList.remove("cherry"),r.classList.remove("peach"),r.classList.add(e)},enumerable:!0})}Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i){i=Object(i);for(var r=Object.keys(i),o=0,a=r.length;a>o;o++){var s=r[o],c=Object.getOwnPropertyDescriptor(i,s);void 0!==c&&c.enumerable&&(t[s]=i[s])}}}return t}}),Object.defineProperty(s.prototype,"magnitude",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}}),s.prototype.toString=function(){return"<Vector x: "+this.x+", y: "+this.y+", z: "+this.z+">"};var b=s,w=Object.freeze({scale:c,normalize:u,dotProduct:l,angle:d,create:b,"default":s});onerror=function(e){alert(e)};var S={setup:"RUNNING"},O=window.console,j=e(S);j.logger=O;var E=i(window);j.view=new r,j.view.addCallback(function(e){E.state=e});p(E,j);j.applyPopState(E.state);var L=o(h,50);window.addEventListener("devicemotion",L);var x=b({x:0,y:0,z:1});return Object.defineProperty(r.prototype,"render",{value:function(e){var t=this;window.cancelAnimationFrame(t.requestID),this.requestID=window.requestAnimationFrame(function(){for(var n in t){var i=e[n];if(void 0==i)return;t[n]=i}})},enumerable:!1}),f(function(){function e(e){var t={x:0,y:0};e.reading&&(t=g(e.reading)),n.splashScreenAcknowledged=e.splashScreenAcknowledged,n.menuVisible=e.menuVisible,n.theme=e.theme,n.loadStatus=m(e.setup),n.angleX=y(t.x),n.angleY=y(t.y)}var t,n=new v(document.documentElement);j.view.addCallback(function(n){window.cancelAnimationFrame(t),t=window.requestAnimationFrame(function(){e(n)})})}),window.Vector=w,setTimeout(function(){j.acknowledgeSplashScreen()},2e3),j}();
//# sourceMappingURL=www/level.min.js.map